# -*- coding: utf-8 -*-

import pandas as pd
from collections import defaultdict

'''
read_data=pd.read_excel('datasets_all.xlsx')
data_label=[]
label_frequency=defaultdict(int)
for i in range(len(read_data)):
    data_label.append(read_data.iloc[i,2])
for i in data_label:
    label_frequency[i] += 1

label_set=set(data_label)
print(label_set)
print(label_frequency)
'''
import matplotlib.pyplot as plt
import numpy as np
import pylab as pl

x=['Cryptographic','Unknow','Configuration Error','Trust Management','Command Injection','Authentication','Race Condition','Numeric Errors','SQL Injection','Boundary Condition','Information Leak','Access Verfication','Path Traversal','Environment Condition','Format String','Code Injection','XSS','CSRF','Design Error','Input Validation','Link Following','Resource Error','Buffer Overflow','Permission Privilege']
values=[477,11284,361,387,131,730,384,999,5391,876,2316,693,2261,5,366,1765,7335,746,2263,5071,319,1852,7307,3518]

# 创建一个点数为 8 x 6 的窗口, 并设置分辨率为 80像素/每英寸
plt.figure(figsize=(6, 6))

# 再创建一个规格为 1 x 1 的子图
plt.subplot(1, 1, 1)
# 柱子总数
N = 24
# 包含每个柱子下标的序列
index = np.arange(N)
# 柱子的宽度
width = 0.35
# 绘制柱状图, 每根柱子的颜色为紫罗兰色
p2 = plt.bar(index, values, width, label="vulnerability", color="#87CEFA")


# 设置横轴标签
plt.xlabel('Vulnerability category')
# 设置纵轴标签
plt.ylabel('The number of vulnerability of different category')

# 添加标题
plt.title('Vulnerability Distribution of different category(2000-2016)')

# 添加纵横轴的刻度
plt.xticks(index, x)
plt.yticks(np.arange(0, 12000, 1000))
pl.xticks(rotation=90,fontsize = 8)

# 添加图例
plt.legend(loc="Vulnerability")
plt.tight_layout()
plt.savefig('Figures/nvd_category.jpg')
plt.show()
plt.tight_layout()

