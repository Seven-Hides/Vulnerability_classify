# -*- coding: utf-8 -*-
import xml.dom.minidom #导入处理xml文件的模块
import pandas as pd

#打开xml文档 并将这个文件对象存入dom变量
dom = xml.dom.minidom.parse('dataset_source/NVD/nvdcve-2002.xml')
#得到文档元素对象
root = dom.documentElement #用于得到dom对象的文档元素，并把获得的对象给root

#获得标签为entry的多组标签
entry_tag=dom.getElementsByTagName('entry')
data1=entry_tag[0] #表示多组标签中的第一个,entry_tag[2]表示这多组标签中的第三个
cve_name=data1.getAttribute("name") #获得元素属性对应的值
print(cve_name)
lenth=entry_tag.length  #获取xml文件中标签对为entry的个数
print(len(entry_tag))   #获取xml文件中标签对为entry的个数
print(lenth)


descript_tag=dom.getElementsByTagName('descript') #获得标签为entry的多组标签
data2=descript_tag[0]
descript=data2.firstChild.data  #获得标签对之间的数据
print(descript)

#获取entry标签的子标签descript之间的数据
data3=dom.getElementsByTagName('entry')[0].getElementsByTagName('descript')[0].firstChild.data
print(data3)


cve_list=[]
descript_list=[]
cve_list.append(cve_name) #将获得的数据存入列表
descript_list.append(descript)
all_dict={'CVE':cve_list,'Decript':descript_list} #将列表存储为字典
df = pd.DataFrame(all_dict) #将字典转换为DataFrame

#将DataFrame数据写入excel表中
with pd.ExcelWriter('new.xls') as Writer:
    df.to_excel(Writer,'Sheet1',index=False)